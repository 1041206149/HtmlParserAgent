# HtmlParserAgent æ–°ç‰ˆæœ¬è¿­ä»£æµç¨‹è¯¦è§£

## ğŸ“‹ æ¦‚è¿°

æ‚¨çš„ HtmlParserAgent å·²ç»å®Œå…¨é‡æ„ï¼Œå®ç°äº†é«˜æ•ˆçš„**å¤šè½®è¿­ä»£å¾ªç¯æµç¨‹**ã€‚æ ¸å¿ƒæ”¹è¿›åŒ…æ‹¬ï¼š

1. âœ… **å¢é‡è¿­ä»£**ï¼šæ¯ä¸€è½®éƒ½åŸºäºå‰ä¸€è½®è¿›è¡Œä¼˜åŒ–ï¼Œè€Œä¸æ˜¯ä»é›¶å¼€å§‹
2. âœ… **Schema åˆå¹¶**ï¼šJSON å­—æ®µè‡ªåŠ¨åˆå¹¶ï¼Œé¿å…å†—ä½™
3. âœ… **æ¸è¿›å¼è§£æå™¨**ï¼šç¬¬ä¸€è½®ç”Ÿæˆï¼Œåç»­è½®æ¬¡åŸºäºå‰ä¸€è½®ä¼˜åŒ–
4. âœ… **å‡†ç¡®ç‡éªŒè¯**ï¼šæ¯è½®éƒ½åœ¨æ‰€æœ‰ URL ä¸ŠéªŒè¯ï¼Œè·Ÿè¸ªå‡†ç¡®ç‡
5. âœ… **çµæ´»çš„å¾ªç¯æ§åˆ¶**ï¼šæ”¯æŒè®¾ç½®å‡†ç¡®ç‡é˜ˆå€¼ã€æœ€å¤§è¿­ä»£æ¬¡æ•°

---

## ğŸ”„ å·¥ä½œæµç¨‹

### ç¬¬ä¸€è½®å®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Round 1 (è½®æ¬¡1)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¾“å…¥: URLs [url1, url2, url3] (å‰3ä¸ªURLä½œä¸ºæ ·æœ¬)            â”‚
â”‚                                                               â”‚
â”‚ Step 1: è·å–HTML & æˆªå›¾ & æå–JSON Schema                  â”‚
â”‚ â”œâ”€ url1: HTML â†’ Screenshot â†’ JSON (groundtruth)            â”‚
â”‚ â”œâ”€ url2: HTML â†’ Screenshot â†’ JSON (groundtruth)            â”‚
â”‚ â””â”€ url3: HTML â†’ Screenshot â†’ JSON (groundtruth)            â”‚
â”‚ â†“                                                             â”‚
â”‚ Step 2: æå–Schema (ä»3ä¸ªJSONåˆå¹¶)                         â”‚
â”‚ â”œâ”€ ç»Ÿè®¡å­—æ®µé¢‘ç‡                                              â”‚
â”‚ â”œâ”€ å­—æ®µå‡ºç°åœ¨â‰¥50%æ ·æœ¬ â†’ required=True                      â”‚
â”‚ â””â”€ è¾“å‡º: schema_v1.json                                     â”‚
â”‚ â†“                                                             â”‚
â”‚ Step 3: ä»é›¶ç”ŸæˆParser                                      â”‚
â”‚ â”œâ”€ è¾“å…¥: reference_html + schema_v1.json                    â”‚
â”‚ â”œâ”€ LLM ç”Ÿæˆ BeautifulSoup ä»£ç                               â”‚
â”‚ â””â”€ è¾“å‡º: generated_parser_v1.py                             â”‚
â”‚ â†“                                                             â”‚
â”‚ Step 4: å…¨é‡éªŒè¯ (åœ¨æ‰€æœ‰URLä¸ŠéªŒè¯)                         â”‚
â”‚ â”œâ”€ å¯¹äºæ¯ä¸ª URL:                                            â”‚
â”‚ â”‚  â”œâ”€ è·å–HTML                                              â”‚
â”‚ â”‚  â”œâ”€ ä½¿ç”¨ generated_parser_v1.py è§£æ â†’ predicted JSON   â”‚
â”‚ â”‚  â”œâ”€ åŠ è½½ groundtruth JSON (å·²ä¿å­˜)                       â”‚
â”‚ â”‚  â””â”€ è®¡ç®—å‡†ç¡®ç‡: accuracy = 0.7Ã—å®Œæ•´æ€§ + 0.3Ã—ç›¸ä¼¼åº¦      â”‚
â”‚ â”œâ”€ æ±‡æ€»: overall_accuracy = avg(accuracy)                   â”‚
â”‚ â””â”€ è¾“å‡º: validation_result                                  â”‚
â”‚                                                               â”‚
â”‚ è¾“å‡º: schema_v1.json, generated_parser_v1.py, å‡†ç¡®ç‡%      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åç»­è½®æ¬¡æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Round N (Nâ‰¥2)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¾“å…¥: æ–°URL url_new (æœªå¤„ç†è¿‡çš„URL)                        â”‚
â”‚       å‰ä¸€è½®çŠ¶æ€: schema_{N-1}.json, generated_parser_{N-1}.pyâ”‚
â”‚                                                               â”‚
â”‚ Step 1: è·å–HTML & æˆªå›¾ & æå–JSON Schema                  â”‚
â”‚ â””â”€ url_new: HTML â†’ Screenshot â†’ JSON (groundtruth)         â”‚
â”‚ â†“                                                             â”‚
â”‚ Step 2: åˆå¹¶Schema (æ–°JSONä¸æ—§Schema)                      â”‚
â”‚ â”œâ”€ åŸºç¡€: å‰ä¸€è½®çš„ schema_{N-1}.json                        â”‚
â”‚ â”œâ”€ æ–°å¢å­—æ®µ: first_appeared_round = N                      â”‚
â”‚ â”œâ”€ å·²æœ‰å­—æ®µ: last_updated_round = N                        â”‚
â”‚ â””â”€ è¾“å‡º: schema_vN.json                                     â”‚
â”‚ â†“                                                             â”‚
â”‚ Step 3: å¢é‡ä¼˜åŒ–Parser                                      â”‚
â”‚ â”œâ”€ è¾“å…¥:                                                    â”‚
â”‚ â”‚  â”œâ”€ previous_code = generated_parser_{N-1}.py             â”‚
â”‚ â”‚  â”œâ”€ new_html = reference HTML                             â”‚
â”‚ â”‚  â””â”€ merged_schema = schema_vN.json                       â”‚
â”‚ â”œâ”€ LLM æ“ä½œ:                                                â”‚
â”‚ â”‚  â”œâ”€ ä¿ç•™å·²æœ‰é€»è¾‘ (å‰ä¸€è½®èƒ½æå–çš„å­—æ®µ)                    â”‚
â”‚ â”‚  â”œâ”€ æ·»åŠ æ–°å­—æ®µæå–                                         â”‚
â”‚ â”‚  â””â”€ æ”¹è¿›é€‰æ‹©å™¨å’Œå®¹é”™                                       â”‚
â”‚ â””â”€ è¾“å‡º: generated_parser_vN.py                            â”‚
â”‚ â†“                                                             â”‚
â”‚ Step 4: å…¨é‡éªŒè¯ (åœ¨æ‰€æœ‰URLä¸ŠéªŒè¯)                         â”‚
â”‚ â”œâ”€ ä½¿ç”¨ generated_parser_vN.py éªŒè¯æ‰€æœ‰URL                 â”‚
â”‚ â”œâ”€ è®¡ç®—æ¯ä¸ªURLçš„å‡†ç¡®ç‡                                      â”‚
â”‚ â””â”€ æ±‡æ€»: overall_accuracy = avg(accuracy)                   â”‚
â”‚                                                               â”‚
â”‚ è¾“å‡º: schema_vN.json, generated_parser_vN.py, å‡†ç¡®ç‡%      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµç¨‹ç»ˆæ­¢æ¡ä»¶

æµç¨‹ä¼šåœ¨ä»¥ä¸‹**ä»»ä¸€æ¡ä»¶**æ»¡è¶³æ—¶ç»ˆæ­¢ï¼š

1. **å‡†ç¡®ç‡è¾¾åˆ°é˜ˆå€¼** ğŸ¯
   - `overall_accuracy >= accuracy_threshold` (é»˜è®¤ 0.8)
   - ç¤ºä¾‹: å‡†ç¡®ç‡ â‰¥ 80%

2. **è¿­ä»£æ¬¡æ•°ä¸Šé™** ğŸ”¢
   - `round_num >= max_iterations`
   - é»˜è®¤ä» `config/settings.py` è¯»å–

3. **æ‰€æœ‰URLå·²å¤„ç†** âœ…
   - åç»­è½®æ¬¡ä¸­æ— æ–°çš„æœªå¤„ç†URL

4. **æ‰§è¡Œå¼‚å¸¸** âŒ
   - ä»»ä½•æ­¥éª¤å‡ºç°è‡´å‘½é”™è¯¯

---

## ğŸ“ è¾“å‡ºæ–‡ä»¶ç»“æ„

```
output/
â”œâ”€â”€ screenshots/                      # æ‰€æœ‰è½®æ¬¡çš„æˆªå›¾
â”‚   â”œâ”€â”€ round_1_sample_1.png
â”‚   â”œâ”€â”€ round_1_sample_2.png
â”‚   â”œâ”€â”€ round_1_sample_3.png
â”‚   â”œâ”€â”€ round_2_sample_1.png
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ parsers/                          # Parserä»£ç å’ŒSchema
â”‚   â”œâ”€â”€ schema_v1.json               # ç¬¬1è½® Schema
â”‚   â”œâ”€â”€ schema_v2.json               # ç¬¬2è½® Schema
â”‚   â”œâ”€â”€ schema_v3.json               # ç¬¬3è½® Schema
â”‚   â”œâ”€â”€ generated_parser_v1.py       # ç¬¬1è½® Parser (ä»é›¶ç”Ÿæˆ)
â”‚   â”œâ”€â”€ generated_parser_v2.py       # ç¬¬2è½® Parser (åŸºäºv1ä¼˜åŒ–)
â”‚   â”œâ”€â”€ generated_parser_v3.py       # ç¬¬3è½® Parser (åŸºäºv2ä¼˜åŒ–)
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ groundtruth/                      # æ¯ä¸ªURLçš„ groundtruth JSON
â”‚   â”œâ”€â”€ 12345678.json                # å›¾ç‰‡è¯†åˆ«çš„ JSON (groundtruth)
â”‚   â”œâ”€â”€ 87654321.json
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ iterations/                       # æ¯è½®è¿­ä»£çš„å…ƒæ•°æ®
    â”œâ”€â”€ round_1_metadata.json        # ç¬¬1è½®è¯¦ç»†ä¿¡æ¯
    â”œâ”€â”€ round_2_metadata.json        # ç¬¬2è½®è¯¦ç»†ä¿¡æ¯
    â””â”€â”€ ...
```

---

## ğŸ§® å‡†ç¡®ç‡è®¡ç®—

### éªŒè¯é€»è¾‘

æ¯ä¸€è½®éƒ½è¦åœ¨**æ‰€æœ‰URL**ä¸Šè¿›è¡ŒéªŒè¯ï¼š

```
For each URL in all_urls:
  1. è·å–HTML
  2. è¿è¡Œå½“å‰Parser â†’ predicted_json
  3. åŠ è½½groundtruth_json (å·²ä¿å­˜çš„JSON)
  4. è®¡ç®— accuracy(predicted_json, groundtruth_json)
  5. è®°å½•ç»“æœ

overall_accuracy = mean(all_accuracies)
```

### å‡†ç¡®ç‡å…¬å¼

```python
def calculate_accuracy(groundtruth: Dict, predicted: Dict) -> float:
    """
    å‡†ç¡®ç‡ = 0.7 Ã— å­—æ®µå®Œæ•´æ€§å¾—åˆ† + 0.3 Ã— å­—æ®µå€¼ç›¸ä¼¼åº¦å¾—åˆ†
    """
    
    # å­—æ®µå®Œæ•´æ€§ï¼špredicted æ˜¯å¦åŒ…å«æ‰€æœ‰ groundtruth å­—æ®µ
    completeness_score = len(predicted_keys âˆ© groundtruth_keys) / len(groundtruth_keys)
    
    # å­—æ®µå€¼ç›¸ä¼¼åº¦ï¼šç›¸åŒå­—æ®µçš„ç±»å‹æ˜¯å¦åŒ¹é…
    match_count = 0
    for key in groundtruth_keys:
        if key in predicted and type(groundtruth[key]) == type(predicted[key]):
            match_count += 1
    value_similarity = match_count / len(groundtruth_keys)
    
    # ç»¼åˆå¾—åˆ†
    accuracy = 0.7 Ã— completeness_score + 0.3 Ã— value_similarity
    
    return accuracy
```

### ç¤ºä¾‹

```
Groundtruth:
{
  "title": "Hello World",       # str
  "date": "2024-01-01",         # str
  "likes": 100                  # int
}

Predicted:
{
  "title": "Hello World",       # str  âœ“
  "date": "2024-01-01",         # str  âœ“
  "likes": "100"                # str  âœ— (type mismatch)
}

å®Œæ•´æ€§å¾—åˆ† = 3/3 = 1.0
ç›¸ä¼¼åº¦å¾—åˆ† = 2/3 = 0.667
å‡†ç¡®ç‡ = 0.7 Ã— 1.0 + 0.3 Ã— 0.667 = 0.9
```

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1ï¼šå‘½ä»¤è¡Œï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

```bash
# åŸºç¡€ç”¨æ³•
python main.py -f urls.txt

# å®Œæ•´å‚æ•°
python main.py \
  -f urls.txt \
  -o output/my_project \
  -t blog_article \
  -d example.com
```

**å‚æ•°è¯´æ˜ï¼š**
- `-f, --file`: URLæ–‡ä»¶è·¯å¾„ï¼ˆæ¯è¡Œä¸€ä¸ªURLï¼‰
- `-o, --output`: è¾“å‡ºç›®å½•ï¼ˆé»˜è®¤: outputï¼‰
- `-t, --type`: é¡µé¢ç±»å‹ï¼ˆå¦‚: blog_article, product_pageï¼‰
- `-d, --domain`: åŸŸåï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨ä»URLæå–ï¼‰

### æ–¹æ³•2ï¼šä»£ç è°ƒç”¨ï¼ˆæ¨èç”¨äºå¼€å‘ç¯å¢ƒï¼‰

```python
from agent import ParserAgent

# åˆå§‹åŒ–Agent
agent = ParserAgent(output_dir="output/my_project")

# è¿è¡Œè¿­ä»£
result = agent.run_iterations(
    urls=[
        "https://example.com/page1",
        "https://example.com/page2",
        "https://example.com/page3",
        "https://example.com/page4",
        "https://example.com/page5",
    ],
    domain="example.com",
    layout_type="article",
    max_iterations=3,                    # æœ€å¤š3è½®è¿­ä»£
    accuracy_threshold=0.85              # å‡†ç¡®ç‡è¾¾åˆ°85%åˆ™åœæ­¢
)

# å¤„ç†ç»“æœ
if result['success']:
    print(f"âœ“ ç”ŸæˆæˆåŠŸï¼")
    print(f"  æ€»è½®æ¬¡: {result['total_rounds']}")
    print(f"  æœ€ç»ˆå‡†ç¡®ç‡: {result['overall_accuracy']:.2%}")
    print(f"  æœ€ç»ˆParser: {result['final_parser_path']}")
    
    # æŸ¥çœ‹æ¯è½®çš„è¯¦ç»†ä¿¡æ¯
    for i, metadata in enumerate(result['history'], 1):
        print(f"\n  Round {i}:")
        print(f"    - å¤„ç†URLæ•°: {len(metadata['round_urls'])}")
        print(f"    - Schemaå­—æ®µæ•°: {len(metadata['schema'])}")
        print(f"    - å‡†ç¡®ç‡: {metadata['overall_accuracy']:.2%}")
else:
    print(f"âœ— ç”Ÿæˆå¤±è´¥: {result.get('error')}")
```

---

## âš™ï¸ é…ç½®å‚æ•°

ç¼–è¾‘ `config/settings.py`ï¼š

```python
# è¿­ä»£é…ç½®
max_iterations = 5                          # æœ€å¤§è¿­ä»£æ¬¡æ•°
success_threshold = 0.8                     # æˆåŠŸé˜ˆå€¼

# ä»£ç ç”Ÿæˆé…ç½®
code_gen_model = "gpt-4-vision"            # ä»£ç ç”Ÿæˆæ¨¡å‹
code_gen_temperature = 0.3                  # ç”Ÿæˆæ¸©åº¦ï¼ˆ0.0-1.0ï¼‰
code_gen_max_tokens = 4000                 # æœ€å¤§tokens

# è§†è§‰æ¨¡å‹é…ç½®
vision_model = "gpt-4-vision"              # è§†è§‰æ¨¡å‹
vision_temperature = 0.2                    # è¯†åˆ«æ¸©åº¦

# LLMé…ç½®
openai_api_key = "sk-..."                  # OpenAI API Key
openai_api_base = "https://api.openai.com/v1"  # APIåŸºåœ°å€
```

---

## ğŸ“Š æ‰§è¡Œæµç¨‹ç¤ºä¾‹

### åœºæ™¯ï¼šå¤„ç†5ä¸ªURL

```
URLs: [url1, url2, url3, url4, url5]
max_iterations: 3
accuracy_threshold: 0.85

æ‰§è¡Œè¿‡ç¨‹ï¼š

Round 1: å¤„ç† url1, url2, url3 (å‰3ä¸ªä½œä¸ºæ ·æœ¬)
â”œâ”€ è·å–HTML â†’ æˆªå›¾ â†’ æå–JSON
â”œâ”€ ç”ŸæˆSchema v1
â”œâ”€ ä»é›¶ç”ŸæˆParser v1
â”œâ”€ éªŒè¯æ‰€æœ‰5ä¸ªURL â†’ accuracy = 0.72 (ä½äºé˜ˆå€¼)
â””â”€ å†å²: [round_1_info]

Round 2: å¤„ç† url4 (æ–°URL)
â”œâ”€ è·å–HTML â†’ æˆªå›¾ â†’ æå–JSON
â”œâ”€ åˆå¹¶Schema â†’ Schema v2
â”œâ”€ ä¼˜åŒ–Parser v1 â†’ Parser v2
â”œâ”€ éªŒè¯æ‰€æœ‰5ä¸ªURL â†’ accuracy = 0.81 (æ¥è¿‘é˜ˆå€¼)
â””â”€ å†å²: [round_1_info, round_2_info]

Round 3: å¤„ç† url5 (æ–°URL)
â”œâ”€ è·å–HTML â†’ æˆªå›¾ â†’ æå–JSON
â”œâ”€ åˆå¹¶Schema â†’ Schema v3
â”œâ”€ ä¼˜åŒ–Parser v2 â†’ Parser v3
â”œâ”€ éªŒè¯æ‰€æœ‰5ä¸ªURL â†’ accuracy = 0.88 (è¾¾åˆ°é˜ˆå€¼ï¼)
â””â”€ å†å²: [round_1_info, round_2_info, round_3_info]

âœ“ æµç¨‹ç»ˆæ­¢ (è¾¾åˆ°å‡†ç¡®ç‡é˜ˆå€¼)

æœ€ç»ˆè¾“å‡ºï¼š
- Parser: generated_parser_v3.py
- Schema: schema_v3.json
- å‡†ç¡®ç‡: 88%
- è½®æ¬¡: 3
```

---

## ğŸ” å…³é”®æ”¹è¿›äº®ç‚¹

### 1. å¢é‡è¿­ä»£è€Œéä»é›¶å¼€å§‹
```python
# âŒ æ—§æ–¹å¼
Round 2: ä»é›¶ç”Ÿæˆ Parser 2 (å¿½ç•¥ Parser 1)

# âœ… æ–°æ–¹å¼
Round 2: åŸºäº Parser 1 â†’ ä¼˜åŒ– â†’ Parser 2 (ä¿ç•™å·²æœ‰é€»è¾‘)
```

### 2. Schemaæ™ºèƒ½åˆå¹¶
```python
# Round 1
schema_v1 = {
    "title": {...},
    "date": {...}
}

# Round 2 (æ–°å¢ author å­—æ®µ)
schema_v2 = {
    "title": {...},           # ä¿ç•™
    "date": {...},            # ä¿ç•™
    "author": {...}           # æ–°å¢
}
```

### 3. å‡†ç¡®ç‡åŠ¨æ€è¿½è¸ª
```python
# æ¯ä¸€è½®éƒ½è®¡ç®—å‡†ç¡®ç‡
Round 1: accuracy = 0.72
Round 2: accuracy = 0.81  â†‘
Round 3: accuracy = 0.88  â†‘
# è§‚å¯Ÿæ”¹è¿›è¶‹åŠ¿ï¼Œæ”¯æŒè‡ªé€‚åº”è¿­ä»£ç­–ç•¥
```

### 4. å…¨é‡éªŒè¯
```python
# âŒ æ—§æ–¹å¼
éªŒè¯: ä»…éªŒè¯æœ¬è½®å¤„ç†çš„URL

# âœ… æ–°æ–¹å¼
éªŒè¯: æœ¬è½®ä¹‹ååœ¨æ‰€æœ‰URLä¸ŠéªŒè¯ (åŒ…æ‹¬å‰é¢è½®æ¬¡å¤„ç†çš„URL)
# ç¡®ä¿æ–°Parserä¸ä¼šç ´åå·²æœ‰åŠŸèƒ½
```

---

## ğŸ“ æ—¥å¿—è¾“å‡ºç¤ºä¾‹

```
===============================================================================
å¼€å§‹å¤šè½®è¿­ä»£æµç¨‹
===============================================================================

================================================================================
è¿­ä»£è½®æ¬¡ 1/3
================================================================================

æ‰§è¡Œç¬¬ 1 è½®
  [1/3] å¤„ç† https://example.com/page1
    [1/3] è·å–HTMLæºç ...
    [2/3] æˆªå›¾...
    [3/3] æå–JSON Schema...
    å¤„ç†æˆåŠŸï¼Œæå–åˆ° 5 ä¸ªå­—æ®µ
  [2/3] å¤„ç† https://example.com/page2
    ...
  [3/3] å¤„ç† https://example.com/page3
    ...
ç¬¬ 1 è½®å®Œæˆï¼š3/3 ä¸ªURLæˆåŠŸå¤„ç†

[ç¬¬ 1 è½® - æ­¥éª¤ 2/5] å¤„ç†JSON Schema
ç¬¬ä¸€è½®ï¼šä» 3 ä¸ªURLä¸­æå–Schema
ç¬¬ä¸€è½®Schemaæå–ï¼š5 ä¸ªå­—æ®µ
Schemaä¿å­˜åˆ°: output/parsers/schema_v1.json

ç”Ÿæˆ/æ›´æ–°è§£æå™¨ï¼ˆç¬¬ 1 è½®ï¼‰
ç¬¬ä¸€è½®ï¼šä»é›¶ç”Ÿæˆè§£æå™¨
åˆå¹¶åçš„SchemaåŒ…å« 5 ä¸ªå­—æ®µ
è§£æå™¨ç”Ÿæˆå®Œæˆ: output/parsers/generated_parser_v1.py

éªŒè¯è§£æå™¨ï¼ˆç¬¬ 1 è½®ï¼‰
    https://example.com/page1: å‡†ç¡®ç‡ 85.0%
    https://example.com/page2: å‡†ç¡®ç‡ 82.0%
    https://example.com/page3: å‡†ç¡®ç‡ 80.0%
    https://example.com/page4: å‡†ç¡®ç‡ 72.0% (å¤±è´¥)
    https://example.com/page5: å‡†ç¡®ç‡ 68.0% (å¤±è´¥)
éªŒè¯å®Œæˆï¼Œæ€»ä½“å‡†ç¡®ç‡: 77.4%

ç¬¬ 1 è½®å®Œæˆ
  æ•´ä½“å‡†ç¡®ç‡: 77.4%
  å¤±è´¥URLæ•°: 2

...ï¼ˆç»§ç»­åç»­è½®æ¬¡ï¼‰...

================================================================================
è¿­ä»£æµç¨‹å®Œæˆ!
================================================================================
```

---

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šæŸè½®éªŒè¯å¤±è´¥
```
ç—‡çŠ¶: "éªŒè¯å¤±è´¥ - æœªæ‰¾åˆ°groundtruth"
åŸå› : ç¬¬ä¸€è½®æ²¡æœ‰æˆåŠŸä¿å­˜æŸä¸ªURLçš„groundtruth
è§£å†³:
  1. æ£€æŸ¥ output/groundtruth/ ç›®å½•
  2. ç¡®ä¿ç¬¬ä¸€è½®æ­£å¸¸å®Œæˆ
  3. æ£€æŸ¥ç½‘ç»œè¿æ¥
```

### é—®é¢˜2ï¼šParserç”Ÿæˆå¤±è´¥
```
ç—‡çŠ¶: "ç”Ÿæˆè§£æå™¨å¤±è´¥"
åŸå› : LLMè°ƒç”¨å¤±è´¥æˆ–HTMLå†…å®¹æœ‰é—®é¢˜
è§£å†³:
  1. æ£€æŸ¥ OPENAI_API_KEY ç¯å¢ƒå˜é‡
  2. æ£€æŸ¥ç½‘ç»œè¿æ¥
  3. æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿— (logs/agent_*.log)
```

### é—®é¢˜3ï¼šå‡†ç¡®ç‡ä¸æé«˜
```
ç—‡çŠ¶: å¤šè½®è¿­ä»£åå‡†ç¡®ç‡ä»ç„¶å¾ˆä½
åŸå› : é¡µé¢ç»“æ„ä¸ä¸€è‡´æˆ–æå–é€»è¾‘æœ‰é—®é¢˜
è§£å†³:
  1. æ£€æŸ¥ output/screenshots/ ä¸­çš„é¡µé¢æˆªå›¾
  2. æ‰‹åŠ¨æ£€æŸ¥ groundtruth JSON æ˜¯å¦æ­£ç¡®
  3. æŸ¥çœ‹ç”Ÿæˆçš„ Parser ä»£ç æ˜¯å¦åˆç†
  4. å¯èƒ½éœ€è¦æ›´æ¢URLæ ·æœ¬æˆ–è°ƒæ•´å‚æ•°
```

---

## ğŸ“š æ–‡ä»¶å¯¹åº”å…³ç³»

| æ–‡ä»¶ | èŒè´£ | å˜æ›´ |
|------|------|------|
| `agent/executor.py` | æ‰§è¡Œå•è½®æµç¨‹ | å®Œå…¨é‡å†™ âœ… |
| `agent/orchestrator.py` | å¤šè½®è¿­ä»£ç¼–æ’ | å®Œå…¨é‡å†™ âœ… |
| `agent/validator.py` | éªŒè¯å™¨ | ä¿æŒä¸å˜ |
| `agent/planner.py` | è§„åˆ’å™¨ | ä¿æŒä¸å˜ |
| `tools/code_generator.py` | ç”ŸæˆParser | ç•¥å¾®è°ƒæ•´ |
| `tools/code_fixer.py` | ä¼˜åŒ–Parser | å®Œå…¨é‡å†™ âœ… |
| `tools/visual_understanding.py` | å›¾ç‰‡â†’JSON | ä¿æŒä¸å˜ |
| `tools/webpage_source.py` | è·å–HTML | ä¿æŒä¸å˜ |
| `tools/webpage_screenshot.py` | æˆªå›¾ | ä¿æŒä¸å˜ |
| `main.py` | ä¸»ç¨‹åº | æ›´æ–°ä½¿ç”¨æ–°æ–¹æ³• âœ… |

---

## âœ¨ æ€»ç»“

æ–°çš„è¿­ä»£æµç¨‹å®ç°äº†ï¼š

1. âœ… **æ™ºèƒ½è¿­ä»£** - æ¯ä¸€è½®éƒ½åŸºäºå‰ä¸€è½®ä¼˜åŒ–ï¼Œæ•ˆç‡æå‡
2. âœ… **åŠ¨æ€Schema** - è‡ªåŠ¨åˆå¹¶æ–°å­—æ®µï¼Œé¿å…å†—ä½™
3. âœ… **å‡†ç¡®ç‡è¿½è¸ª** - é€šè¿‡groundtruthç²¾ç¡®è®¡ç®—ï¼Œæ”¯æŒè‡ªé€‚åº”åœæ­¢
4. âœ… **å¢é‡Parser** - ä¿ç•™å·²æœ‰é€»è¾‘ï¼Œåªæ·»åŠ æ–°åŠŸèƒ½ï¼Œé™ä½ç ´åé£é™©
5. âœ… **å…¨é‡éªŒè¯** - æ¯è½®éªŒè¯æ‰€æœ‰URLï¼Œä¿è¯æ•´ä½“è´¨é‡

**å»ºè®®çš„ä½¿ç”¨æµç¨‹ï¼š**
1. å‡†å¤‡5-10ä¸ªURLæ ·æœ¬
2. è®¾ç½® `accuracy_threshold = 0.85` å’Œ `max_iterations = 5`
3. è¿è¡Œ `python main.py -f urls.txt`
4. ç›‘æ§æ—¥å¿—å’Œå‡†ç¡®ç‡å˜åŒ–
5. æ ¹æ®ç»“æœè°ƒæ•´å‚æ•°ï¼Œé‡æ–°è¿è¡Œ

